
# This file was generated by the Tkinter Designer by Parth Jadhav
# https://github.com/ParthJadhav/Tkinter-Designer


from pathlib import Path
import ttkbootstrap as ttk
from tkinter import *
import pandas as pd
from pandastable import Table
from tkinter import Tk, Canvas, Entry, Text, Button, PhotoImage
from append import Append

OUTPUT_PATH = Path(__file__).parent
ASSETS_PATH = OUTPUT_PATH / Path(r"C:\Users\Admin\Desktop\Python LAB tkinter\build\assets\frame0")


class MainWindow(ttk.Window):
    def __init__(self):
        super().__init__()

        enemies = pd.read_excel('C:/Users/Admin/Desktop/Python LAB tkinter/build/enemies.xlsx')
        boss = pd.read_excel('C:/Users/Admin/Desktop/Python LAB tkinter/build/boss.xlsx')

        def relative_to_assets(path: str) -> Path:
            return ASSETS_PATH / Path(path)
        

        self.geometry("1280x720")
        self.image = PhotoImage(file ='C:/Users/Admin/Desktop/Python LAB tkinter/build/hk.png')
        bg_logo=Label(self, image=self.image)
        bg_logo.grid(row=0, column = 0)
        # self.configure(bg ="#323551")
        self.title("Hollow Knight db")
        self.iconbitmap("C:/Users/Admin/Desktop/Python LAB tkinter/build/cource/hollowknight64.ico")

        # self.notebook = ttk.Notebook(self)

        # tab1 = ttk.Frame(self.notebook)

        # df = pd.read_excel('C:/Users/Admin/Desktop/Python LAB tkinter/build/enemies.xlsx')

        
        # table = Table(tab1,dataframe=df)
        # table.show()
        


        # button_image_1 = PhotoImage(
        #     file=relative_to_assets("button_1.png"))
        # self.button_1 = Button(
        #     image=button_image_1,
        #     borderwidth=0,
        #     highlightthickness=0,
        #     command=lambda: print("button_1 clicked"),
        #     relief="flat"
        # )
        # self.button_1.place(
        #     x=1010.0,
        #     y=324.0,
        #     width=216.0,
        #     height=72.0
        # )
        def find():
            table1.findText(evt=None)


        button_image_3 = PhotoImage(
            file=relative_to_assets("button_3.png"))
        self.button_3 = Button(
            image=button_image_3,
            borderwidth=0,
            highlightthickness=0,
            command=find,
            relief="flat"
        )
        self.button_3.place(
            x=42.0,
            y=39.0,
            width=216.0,
            height=45.0
        )

        # button_image_4 = PhotoImage(
        #     file=relative_to_assets("button_4.png"))
        # self.button_4 = Button(
        #     image=button_image_4,
        #     borderwidth=0,
        #     highlightthickness=0,
        #     command=lambda: print("button_4 clicked"),
        #     relief="flat"
        # )
        # self.button_4.place(
        #     x=1008.0,
        #     y=213.0,
        #     width=216.0,
        #     height=72.0
        # )

        def winappend():
            Append()

        button_image_5 = PhotoImage(
            file=relative_to_assets("button_5.png"))
        self.button_5 = Button(
            image=button_image_5,
            borderwidth=0,
            highlightthickness=0,
            command = winappend,
            relief="flat"
        )
        self.button_5.place(
            x=1008.0,
            y=103.0,
            width=216.0,
            height=72.0
        )

        def refresh():
            new_df1 = pd.read_excel('C:/Users/Admin/Desktop/Python LAB tkinter/build/enemies.xlsx')
            new_df2 = pd.read_excel('C:/Users/Admin/Desktop/Python LAB tkinter/build/boss.xlsx')
            table1.model.df = new_df1
            table2.model.df = new_df2
            table1.update()
            table2.update()
            # table1.loadExcel(filename='C:/Users/Admin/Desktop/Python LAB tkinter/build/enemies.xlsx')
            # table2.loadExcel(filename='C:/Users/Admin/Desktop/Python LAB tkinter/build/boss.xlsx')
            

        button_image_2 = PhotoImage(
            file=relative_to_assets("button_2.png"))
        self.button_2 = Button(
            image=button_image_2,
            borderwidth=0,
            highlightthickness=0,
            command= refresh,
            relief="flat"
        )
        self.button_2.place(
            x=1008.0,
            y=597.0,
            width=216.0,
            height=72.0
        )
        self.notebook = ttk.Notebook(self)

        tab1 = ttk.Frame(self.notebook)

        tab2 = ttk.Frame(self.notebook)

        tab3 = ttk.Frame(self.notebook)


        self.notebook.add(tab1,text='Part I')
        self.notebook.add(tab2,text='Part II')
        self.notebook.add(tab2,text='Part III')
        self.notebook.pack(pady = 10)


        self.resizable(False, False)
        self.mainloop()


